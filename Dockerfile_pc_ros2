FROM osrf/ros:foxy-desktop

LABEL label=doodlenet_ros2:beta
ARG DEBIAN_FRONTEND=noninteractive
ENV SHELL /bin/bash
SHELL ["/bin/bash","-c"]

# Proxy Setup
ENV HTTP_PROXY=http://172.20.73.40:8080
ENV HTTPS_PROXY=http://172.20.73.40:8080
ENV http_proxy=http://172.20.73.40:8080
ENV https_proxy=http://172.20.73.40:8080
ENV NO_PROXY="127.0.0.1, localhost, 192.168.8.*, 172.16.*, 10.*, *.denso, *.densoshare.com, *.denso.co.jp, *.scm.globaldenso.com, sftp.denso.nl, *.elearn.denso.nl, *.emea.denso"
COPY apt.conf /etc/apt/apt.conf


RUN apt-get update -y && \
    apt-get install -y python3-pip python-dev python3-opencv lsb-release curl gnupg2 python3-tk
    

RUN apt update && apt install -y \
  build-essential \
  cmake \
  git \
  git-lfs \
  wget \
  nano
  
RUN apt-get update && apt-get install -y --no-install-recommends \
    build-essential \
    gcc \
    python3-dev \
    python3-pip \
    cmake \
    apt-utils \
    openssh-client \
    expect \
    openssh-server \
    zip unzip \
    tree \
    screen \
    cifs-utils

WORKDIR /app

COPY . /app

RUN pip install -r requirements_pc.txt

# download torch .pth model 
RUN mkdir model_weights && cd model_weights && gdown 1ooz2HL0Fjrk9hl8Z6-_k_6jQqH2_LOaa
